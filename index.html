<!doctype html>
<html lang="ru" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü–æ–¥–∞—Ä–æ–∫ –¥–ª—è —Ç–µ–±—è</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      box-sizing: border-box;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    @keyframes pulse-glow {
      0%, 100% { filter: drop-shadow(0 0 10px rgba(255, 182, 193, 0.5)); }
      50% { filter: drop-shadow(0 0 20px rgba(255, 182, 193, 0.8)); }
    }

    @keyframes open-card {
      0% { transform: rotateY(0deg); }
      100% { transform: rotateY(-180deg); }
    }

    @keyframes move-to-center {
      0% {
        transform: translate(0, 0) scale(1);
      }
      100% {
        transform: translate(0, 0) scale(2);
      }
    }

    .card-moving {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
      animation: move-to-center 1s ease-in-out forwards;
    }

    .float-animation {
      animation: float 3s ease-in-out infinite;
    }

    .glow-animation {
      animation: pulse-glow 2s ease-in-out infinite;
    }

    .gift-item {
      cursor: pointer;
      transition: transform 0.3s ease, opacity 0.5s ease;
    }

    .gift-item:hover {
      transform: scale(1.1);
    }

    .card-container {
      perspective: 1000px;
    }

    .card-front, .card-back {
      backface-visibility: hidden;
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .card-front {
      z-index: 2;
      transform: rotateY(0deg);
    }

    .card-back {
      transform: rotateY(180deg);
    }

    .card-open .card-front {
      animation: open-card 0.8s forwards;
    }

    .message-box {
      background: linear-gradient(135deg, rgba(255, 182, 193, 0.2), rgba(255, 105, 180, 0.2));
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 182, 193, 0.3);
    }

    @keyframes fall {
      0% {
        top: -10%;
        opacity: 1;
      }
      100% {
        top: 110%;
        opacity: 0.3;
      }
    }

    .falling-heart {
      position: fixed;
      font-size: 30px;
      animation: fall linear infinite;
      z-index: 999;
      pointer-events: none;
    }

    .big-heart {
      font-size: 150px;
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full">
  <div id="app" class="h-full w-full overflow-auto" style="background: #000000;"><!-- Level 1: Collect Hearts -->
   <div id="level1-screen" class="min-h-full w-full flex flex-col items-center justify-center p-8">
    <h1 class="text-5xl font-bold text-center mb-4 glow-animation" style="color: #FFB6C1; font-family: 'Georgia', serif;">–£—Ä–æ–≤–µ–Ω—å 1: –°–æ–±–µ—Ä–∏ —Å–µ—Ä–¥–µ—á–∫–∏! üíï</h1>
    <div class="text-2xl mb-8" style="color: #FFB6C1; font-family: 'Georgia', serif;">
     –û—Å—Ç–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å: <span id="hearts-left">10</span> ‚ù§Ô∏è
    </div>
    <div id="game-area" class="relative w-full max-w-4xl mx-auto" style="height: 400px; border: 3px dashed #FFB6C1; border-radius: 20px; overflow: hidden;">
    </div>
   </div><!-- Level 2: Guess Color -->
   <div id="level2-screen" class="min-h-full w-full flex-col items-center justify-center p-8" style="display: none;">
    <h1 class="text-5xl font-bold text-center mb-4 glow-animation" style="color: #FFB6C1; font-family: 'Georgia', serif;">–£—Ä–æ–≤–µ–Ω—å 2: –ö–∞–∫–æ–π —Ç–≤–æ–π –ª—é–±–∏–º—ã–π —Ü–≤–µ—Ç? üé®</h1>
    <p class="text-2xl text-center mb-8" style="color: #FFB6C1; font-family: 'Georgia', serif;">–í—ã–±–µ—Ä–∏ —Ü–≤–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω—Ä–∞–≤–∏—Ç—Å—è —Ç–µ–±–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ!</p>
    <div class="flex flex-wrap gap-6 justify-center max-w-3xl mx-auto">
     <div class="color-choice w-32 h-32 rounded-full cursor-pointer transition-transform hover:scale-110" style="background: #FF0000;" data-color="#FF0000"></div>
     <div class="color-choice w-32 h-32 rounded-full cursor-pointer transition-transform hover:scale-110" style="background: #FF7F00;" data-color="#FF7F00"></div>
     <div class="color-choice w-32 h-32 rounded-full cursor-pointer transition-transform hover:scale-110" style="background: #FFFF00;" data-color="#FFFF00"></div>
     <div class="color-choice w-32 h-32 rounded-full cursor-pointer transition-transform hover:scale-110" style="background: #00FF00;" data-color="#00FF00"></div>
     <div class="color-choice w-32 h-32 rounded-full cursor-pointer transition-transform hover:scale-110" style="background: #0000FF;" data-color="#0000FF"></div>
     <div class="color-choice w-32 h-32 rounded-full cursor-pointer transition-transform hover:scale-110" style="background: #4B0082;" data-color="#4B0082"></div>
     <div class="color-choice w-32 h-32 rounded-full cursor-pointer transition-transform hover:scale-110" style="background: #9400D3;" data-color="#9400D3"></div>
    </div>
   </div><!-- Level 3: Memory Game -->
   <div id="level3-screen" class="min-h-full w-full flex-col items-center justify-center p-8" style="display: none;">
    <h1 class="text-5xl font-bold text-center mb-4 glow-animation" style="color: #FFB6C1; font-family: 'Georgia', serif;">–£—Ä–æ–≤–µ–Ω—å 3: –ù–∞–π–¥–∏ –ø–∞—Ä—ã! üíù</h1>
    <p class="text-2xl text-center mb-8" style="color: #FFB6C1; font-family: 'Georgia', serif;">–ù–∞–π–¥–∏ –≤—Å–µ 6 –ø–∞—Ä —Å–µ—Ä–¥–µ—á–µ–∫! –û—Å—Ç–∞–ª–æ—Å—å: <span id="pairs-left">6</span></p>
    <div id="memory-grid" class="grid grid-cols-4 gap-4 max-w-2xl mx-auto">
    </div>
   </div><!-- Gifts Screen -->
   <div id="gifts-screen" class="min-h-full w-full flex-col items-center justify-center p-8" style="display: none;">
    <h1 id="title" class="text-5xl font-bold text-center mb-12 glow-animation" style="color: #FFB6C1; font-family: 'Georgia', serif; transition: opacity 0.5s ease;">–ü–æ–¥–∞—Ä–æ—á–µ–∫ –¥–ª—è –ª—é–±–∏–º–æ–π üéÅ</h1>
    <div class="relative w-full max-w-4xl mx-auto"><!-- Bunny SVG -->
     <div class="flex justify-center mb-8">
      <div class="float-animation" style="transition: opacity 0.5s ease;"><img src="https://www.svgrepo.com/show/267732/bunny-rabbit.svg" alt="–ú–∏–ª—ã–π –∑–∞–π—á–∏–∫" width="200" height="200" loading="lazy" onerror="console.error('Image failed to load:', this.src); this.style.background='#FFB6C1'; this.alt='–ó–∞–π—á–∏–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω';">
      </div>
     </div><!-- Gift Items -->
     <div class="flex justify-around items-center flex-wrap gap-8 mb-12"><!-- Candy -->
      <div class="gift-item" id="candy">
       <svg width="100" height="100" viewbox="0 0 100 100"><ellipse cx="50" cy="50" rx="25" ry="30" fill="#FF1493" opacity="0.8" /> <rect x="25" y="45" width="50" height="10" fill="#FF69B4" rx="5" /> <path d="M30 50 L20 45 L20 55 Z" fill="#FF1493" /> <path d="M70 50 L80 45 L80 55 Z" fill="#FF1493" /> <circle cx="50" cy="50" r="3" fill="#FFF" />
       </svg>
      </div><!-- Bouquet -->
      <div class="gift-item" id="bouquet">
       <div style="font-size: 80px;">
        üíê
       </div>
      </div><!-- Card -->
      <div class="gift-item card-container" id="card-container">
       <div id="card" style="width: 100px; height: 100px; position: relative;">
        <div class="card-front">
         <svg width="100" height="100" viewbox="0 0 100 100"><rect x="10" y="20" width="80" height="60" fill="#FFB6C1" rx="5" /> <rect x="15" y="25" width="70" height="50" fill="#FFF" rx="3" /> <path d="M50 40 L55 50 L50 48 L45 50 Z" fill="#FF69B4" /> <text x="50" y="65" text-anchor="middle" font-size="12" fill="#FF1493" font-family="Arial">
           üíå
          </text>
         </svg>
        </div>
        <div class="card-back">
         <svg width="100" height="100" viewbox="0 0 100 100"><rect x="10" y="20" width="80" height="60" fill="#FFF" rx="5" /> <text x="50" y="55" text-anchor="middle" font-size="10" fill="#FF1493" font-family="Arial">
           ‚ù§Ô∏è
          </text>
         </svg>
        </div>
       </div>
      </div>
     </div><!-- Message Display -->
     <div id="message-container" class="text-center" style="min-height: 150px;">
      <div id="big-heart-container" class="hidden mb-8"></div>
      <div id="message" class="message-box rounded-2xl p-8 mx-auto max-w-2xl hidden">
       <p id="message-text" class="text-2xl leading-relaxed" style="color: #FFB6C1; font-family: 'Georgia', serif;"></p>
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
    const defaultConfig = {
      candy_text: "–¢—ã —Å–ª–∞—â–µ –ª—é–±–æ–π –∫–æ–Ω—Ñ–µ—Ç—ã! –ö–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç —Å —Ç–æ–±–æ–π ‚Äî –∫–∞–∫ –≤–∫—É—Å –ª—é–±–∏–º–æ–≥–æ –ª–∞–∫–æ–º—Å—Ç–≤–∞. üç¨üíï –¢–≤–æ—è —É–ª—ã–±–∫–∞ —Å–ª–∞—â–µ —à–æ–∫–æ–ª–∞–¥–∞, –∞ —Ç–≤–æ–π —Å–º–µ—Ö ‚Äî –≤–∫—É—Å–Ω–µ–µ –∫–∞—Ä–∞–º–µ–ª–∏. –ö–æ–≥–¥–∞ —Ç—ã —Ä—è–¥–æ–º, –≤–µ—Å—å –º–∏—Ä –∫–∞–∂–µ—Ç—Å—è —Å–∞—Ö–∞—Ä–Ω–æ–π –≤–∞—Ç–æ–π. –¢—ã ‚Äî –º–æ—è –ª—é–±–∏–º–∞—è —Å–ª–∞–¥–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–æ–π –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–≤–∞–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ö–∞–∂–¥—ã–π –¥–µ–Ω—å —Å —Ç–æ–±–æ–π ‚Äî —ç—Ç–æ –∫–∞–∫ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –Ω–æ–≤—É—é –∫–æ—Ä–æ–±–∫—É –∫–æ–Ω—Ñ–µ—Ç, –ø–æ–ª–Ω—É—é —Å—é—Ä–ø—Ä–∏–∑–æ–≤. –¢–≤–æ—è –Ω–µ–∂–Ω–æ—Å—Ç—å —Ç–∞–µ—Ç –≤–æ –º–Ω–µ, –∫–∞–∫ –∫–æ–Ω—Ñ–µ—Ç–∞ –Ω–∞ —è–∑—ã–∫–µ. –¢—ã –¥–µ–ª–∞–µ—à—å –º–æ—é –∂–∏–∑–Ω—å —Ç–∞–∫–æ–π —Å–ª–∞–¥–∫–æ–π –∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–π. –Ø —Ö–æ—á—É –¥–µ–ª–∏—Ç—å—Å—è —Å —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–º —Å–ª–∞–¥–∫–∏–º –º–≥–Ω–æ–≤–µ–Ω–∏–µ–º –Ω–∞—à–µ–π –∂–∏–∑–Ω–∏. –¢—ã ‚Äî –º–æ–π –ª—é–±–∏–º—ã–π –≤–∫—É—Å —Å—á–∞—Å—Ç—å—è. –õ—é–±–ª—é —Ç–µ–±—è –±–æ–ª—å—à–µ, —á–µ–º –≤—Å–µ –∫–æ–Ω—Ñ–µ—Ç—ã –≤ –º–∏—Ä–µ! üíñ",
      bouquet_text: "–≠—Ç–∏ —Ü–≤–µ—Ç—ã –Ω–µ —Å—Ä–∞–≤–Ω—è—Ç—Å—è —Å —Ç–≤–æ–µ–π –∫—Ä–∞—Å–æ—Ç–æ–π. –¢—ã ‚Äî —Å–∞–º—ã–π –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç–æ–∫ –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏. üå∏üíñ –ö–∞–∫ —Ä–æ–∑—ã –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ —Å–æ–ª–Ω—Ü–µ, —Ç–∞–∫ –∏ —è –Ω—É–∂–¥–∞—é—Å—å –≤ —Ç–µ–±–µ. –¢–≤–æ—è –∫—Ä–∞—Å–æ—Ç–∞ —Ü–≤–µ—Ç—ë—Ç –≤ –º–æ—ë–º —Å–µ—Ä–¥—Ü–µ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –¢—ã –∞—Ä–æ–º–∞—Ç–Ω–µ–µ —Å–∞–º–æ–≥–æ –Ω–µ–∂–Ω–æ–≥–æ –±—É–∫–µ—Ç–∞. –ö–∞–∂–¥—ã–π –ª–µ–ø–µ—Å—Ç–æ–∫ —ç—Ç–∏—Ö —Ü–≤–µ—Ç–æ–≤ ‚Äî —ç—Ç–æ –º–æ—è –º—ã—Å–ª—å –æ —Ç–µ–±–µ. –¢—ã —Ä–∞—Å—Ü–≤–µ—Ç–∞–µ—à—å –≤ –º–æ–µ–π –¥—É—à–µ, –∫–∞–∫ –≤–µ—Å–µ–Ω–Ω–∏–π —Å–∞–¥. –¢–≤–æ–∏ –≥–ª–∞–∑–∞ —è—Ä—á–µ –ª—é–±—ã—Ö —Ü–≤–µ—Ç–æ–≤. –Ø –≥–æ—Ç–æ–≤ –¥–∞—Ä–∏—Ç—å —Ç–µ–±–µ —Ü–≤–µ—Ç—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, –ª–∏—à—å –±—ã –≤–∏–¥–µ—Ç—å —Ç–≤–æ—é —É–ª—ã–±–∫—É. –¢—ã ‚Äî –º–æ–π —Å–∞–º—ã–π —Ä–µ–¥–∫–∏–π –∏ –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–π —Ü–≤–µ—Ç–æ–∫. –° —Ç–æ–±–æ–π –º–æ—è –∂–∏–∑–Ω—å —Ä–∞—Å—Ü–≤–µ—Ç–∞–µ—Ç –≤—Å–µ–º–∏ –∫—Ä–∞—Å–∫–∞–º–∏ —Ä–∞–¥—É–≥–∏. –õ—é–±–ª—é —Ç–µ–±—è, –º–æ—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è! üåπ",
      card_text: "–ü—Ä–æ—Å—Ç–∏ –ª—é–±–∏–º–∞—è —á—Ç–æ —ç—Ç–æ –Ω–µ —Ç–æ—Ç –∑–∞—è—Ü –∫–æ—Ç–æ—Ä–æ–≥–æ —Ç—ã —Ö–æ—Ç–µ–ª–∞, –Ω–µ—Ç—É —Ü–≤–µ—Ç–∫–æ–≤ –∏ –ø—Ä–æ–≤–æ–ª–∫–∏ —Ç–µ—Ö, –∏ —Ö–æ—Ç—å –º—ã –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏, —è –≤—Å—ë —Ä–∞–≤–Ω–æ —Ç–µ–±—è –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –ª—é–±–ª—é –∏ –≤–µ—Ä—é —á—Ç–æ –º—ã –∫–æ–≥–¥–∞-—Ç–æ –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è –≤–∂–∏–≤—É—é, –∏ —è —Å–º–æ–≥—É –¥–∞—Ä–∏—Ç—å —Ç–µ–±–µ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏)) üíù"
    };

    let config = { ...defaultConfig };
    let cardOpened = false;
    let heartsCollected = 0;
    const totalHearts = 10;
    let currentLevel = 1;
    let selectedColor = '#FF1493';

    // LEVEL 1: Collect Hearts Game Logic
    function createClickableHeart() {
      const gameArea = document.getElementById('game-area');
      const heart = document.createElement('div');
      heart.textContent = '‚ù§Ô∏è';
      heart.style.position = 'absolute';
      heart.style.fontSize = '40px';
      heart.style.cursor = 'pointer';
      heart.style.transition = 'transform 0.2s';
      heart.style.left = Math.random() * (gameArea.offsetWidth - 50) + 'px';
      heart.style.top = Math.random() * (gameArea.offsetHeight - 50) + 'px';
      
      heart.addEventListener('mouseenter', () => {
        heart.style.transform = 'scale(1.3)';
      });
      
      heart.addEventListener('mouseleave', () => {
        heart.style.transform = 'scale(1)';
      });
      
      heart.addEventListener('click', () => {
        heart.style.transform = 'scale(0)';
        heartsCollected++;
        document.getElementById('hearts-left').textContent = totalHearts - heartsCollected;
        
        setTimeout(() => {
          heart.remove();
        }, 200);
        
        if (heartsCollected < totalHearts) {
          setTimeout(() => createClickableHeart(), 300);
        } else {
          setTimeout(() => {
            document.getElementById('level1-screen').style.display = 'none';
            document.getElementById('level2-screen').style.display = 'flex';
            currentLevel = 2;
          }, 500);
        }
      });
      
      gameArea.appendChild(heart);
    }

    // Start level 1 with first 3 hearts
    setTimeout(() => createClickableHeart(), 500);
    setTimeout(() => createClickableHeart(), 800);
    setTimeout(() => createClickableHeart(), 1100);

    // LEVEL 2: Color Choice Logic
    document.querySelectorAll('.color-choice').forEach(colorBtn => {
      colorBtn.addEventListener('click', function() {
        selectedColor = this.dataset.color;
        this.style.transform = 'scale(1.3)';
        this.style.boxShadow = '0 0 30px rgba(255, 182, 193, 0.8)';
        
        setTimeout(() => {
          document.getElementById('level2-screen').style.display = 'none';
          document.getElementById('level3-screen').style.display = 'flex';
          currentLevel = 3;
          initMemoryGame();
        }, 800);
      });
    });

    // LEVEL 3: Memory Game Logic
    const memoryEmojis = ['üíï', 'üíñ', 'üíó', 'üíù', 'üíû', 'üíì'];
    let memoryCards = [...memoryEmojis, ...memoryEmojis];
    let flippedCards = [];
    let matchedPairs = 0;

    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function initMemoryGame() {
      const grid = document.getElementById('memory-grid');
      grid.innerHTML = '';
      memoryCards = shuffleArray([...memoryEmojis, ...memoryEmojis]);
      
      memoryCards.forEach((emoji, index) => {
        const card = document.createElement('div');
        card.className = 'memory-card';
        card.style.width = '100px';
        card.style.height = '100px';
        card.style.background = '#FFB6C1';
        card.style.borderRadius = '15px';
        card.style.display = 'flex';
        card.style.alignItems = 'center';
        card.style.justifyContent = 'center';
        card.style.fontSize = '50px';
        card.style.cursor = 'pointer';
        card.style.transition = 'transform 0.3s, background 0.3s';
        card.dataset.emoji = emoji;
        card.dataset.index = index;
        card.textContent = '‚ùì';
        
        card.addEventListener('click', () => flipCard(card));
        grid.appendChild(card);
      });
    }

    function flipCard(card) {
      if (flippedCards.length >= 2 || card.dataset.flipped === 'true') return;
      
      card.textContent = card.dataset.emoji;
      card.style.background = '#FF69B4';
      card.dataset.flipped = 'true';
      flippedCards.push(card);
      
      if (flippedCards.length === 2) {
        setTimeout(checkMatch, 800);
      }
    }

    function checkMatch() {
      const [card1, card2] = flippedCards;
      
      if (card1.dataset.emoji === card2.dataset.emoji) {
        card1.style.opacity = '0.5';
        card2.style.opacity = '0.5';
        card1.style.cursor = 'default';
        card2.style.cursor = 'default';
        matchedPairs++;
        document.getElementById('pairs-left').textContent = 6 - matchedPairs;
        
        if (matchedPairs === 6) {
          setTimeout(() => {
            document.getElementById('level3-screen').style.display = 'none';
            document.getElementById('gifts-screen').style.display = 'flex';
          }, 1000);
        }
      } else {
        card1.textContent = '‚ùì';
        card2.textContent = '‚ùì';
        card1.style.background = '#FFB6C1';
        card2.style.background = '#FFB6C1';
        card1.dataset.flipped = 'false';
        card2.dataset.flipped = 'false';
      }
      
      flippedCards = [];
    }

    async function onConfigChange(newConfig) {
      config = { ...newConfig };
    }

    function showMessage(text) {
      const messageBox = document.getElementById('message');
      const messageText = document.getElementById('message-text');
      
      messageText.textContent = text;
      messageBox.classList.remove('hidden');
      
      setTimeout(() => {
        messageBox.style.opacity = '0';
        messageBox.style.transition = 'opacity 0.5s';
      }, 100);
      
      setTimeout(() => {
        messageBox.style.opacity = '1';
      }, 150);
    }

    document.getElementById('candy').addEventListener('click', () => {
      showMessage(config.candy_text || defaultConfig.candy_text);
    });

    document.getElementById('bouquet').addEventListener('click', () => {
      showMessage(config.bouquet_text || defaultConfig.bouquet_text);
    });

    function createFallingHeart() {
      const heart = document.createElement('div');
      heart.className = 'falling-heart';
      heart.textContent = '‚ù§Ô∏è';
      heart.style.left = Math.random() * 100 + '%';
      heart.style.animationDuration = (Math.random() * 3 + 3) + 's';
      heart.style.animationDelay = Math.random() * 2 + 's';
      document.body.appendChild(heart);
      
      setTimeout(() => {
        heart.remove();
      }, 8000);
    }

    function startFallingHearts() {
      setInterval(createFallingHeart, 500);
    }

    document.getElementById('card-container').addEventListener('click', (e) => {
      if (!cardOpened) {
        const cardContainer = document.getElementById('card-container');
        const card = document.getElementById('card');
        
        // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–¥–∞—Ä–∫–æ–≤
        const messageBox = document.getElementById('message');
        messageBox.style.opacity = '0';
        messageBox.classList.add('hidden');
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞
        cardContainer.style.filter = `drop-shadow(0 0 20px ${selectedColor}) drop-shadow(0 0 40px ${selectedColor})`;
        
        // –°–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
        document.getElementById('candy').style.opacity = '0';
        document.getElementById('bouquet').style.opacity = '0';
        document.getElementById('title').style.opacity = '0';
        document.querySelector('img[alt="–ú–∏–ª—ã–π –∑–∞–π—á–∏–∫"]').parentElement.style.opacity = '0';
        
        // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –æ—Ç–∫—Ä—ã—Ç–∫—É –≤ —Ü–µ–Ω—Ç—Ä
        cardContainer.classList.add('card-moving');
        cardOpened = true;
        
        // –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ—Ç–∫—Ä—ã—Ç–∫—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
        setTimeout(() => {
          card.classList.add('card-open');
        }, 1000);
        
        // –ó–∞–º–µ–Ω—è–µ–º –æ—Ç–∫—Ä—ã—Ç–∫—É –Ω–∞ –±–æ–ª—å—à–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç
        setTimeout(() => {
          cardContainer.style.display = 'none';
          const heartContainer = document.getElementById('big-heart-container');
          heartContainer.innerHTML = '<div class="big-heart">‚ù§Ô∏è</div>';
          heartContainer.classList.remove('hidden');
          showMessage(config.card_text || defaultConfig.card_text);
          
          // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–∞–¥–∞—é—â–∏–µ —Å–µ—Ä–¥–µ—á–∫–∏
          startFallingHearts();
          
          // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–∞–π—Ç —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–æ–∫–∞–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
          setTimeout(() => {
            window.close();
          }, 10000);
        }, 1800);
      }
    });

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || '#000000',
              set: (value) => {
                config.background_color = value;
                document.getElementById('app').style.background = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.primary_color || '#FFB6C1',
              set: (value) => {
                config.primary_color = value;
                const elements = document.querySelectorAll('[style*="color: #FFB6C1"]');
                elements.forEach(el => el.style.color = value);
                window.elementSdk.setConfig({ primary_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['candy_text', config.candy_text || defaultConfig.candy_text],
          ['bouquet_text', config.bouquet_text || defaultConfig.bouquet_text],
          ['card_text', config.card_text || defaultConfig.card_text]
        ])
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c79ff4503a32deb',t:'MTc3MDAzODU0NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
